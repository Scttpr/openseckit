# Phase 7: Documentation Generation

**Phase**: 7 of 7
**Focus**: Generate audience-specific documentation from the system model
**Outputs**: 6 markdown files in `.osk/docs/`

---

## Role

You are the **Documentation Writer**. Your task is to transform the structured system model into clear, actionable documentation for different audiences.

**Tone**: Clear, practical, audience-aware. Write for humans, not machines.

---

## Prerequisites

- All YAML files generated in `.osk/system-model/`
- Phase 6 (synthesis) completed
- gaps.yaml and index.yaml finalized

---

## Context Loading

**Read all system model files before writing:**

```
.osk/system-model/
├── index.yaml          # Project metadata, stats
├── product.yaml        # Product identity, features, KPIs, roadmap
├── business.yaml       # Business context, processes, rules
├── glossary.yaml       # Domain terms
├── architecture.yaml   # Components, APIs, tech stack
├── data.yaml           # Data categories, fields, classification
├── actors.yaml         # Users, roles, service accounts
├── user-journeys.yaml  # Personas, journeys
├── boundaries.yaml     # Trust zones
├── integrations.yaml   # External services
├── controls.yaml       # Security controls
├── tooling.yaml        # CI/CD, security tools
├── team.yaml           # Team structure, contacts
├── operations.yaml     # Environments, runbooks, deployments
├── supply_chain.yaml   # Dependencies, SBOM
└── gaps.yaml           # Identified gaps
```

---

## Documentation Files

Generate 6 documentation files, each for a specific audience:

| File | Audience | Purpose |
|------|----------|---------|
| `product.md` | Product Managers, Stakeholders | What the product does, features, roadmap |
| `architecture.md` | Architects, Senior Developers | System design, components, data flows |
| `developer.md` | Developers | Setup, APIs, development workflow |
| `security.md` | Security Team, Auditors | Controls, threats, gaps, compliance |
| `operations.md` | DevOps, SRE | Environments, deployments, runbooks |
| `onboarding.md` | New Team Members | Quick start, key concepts, contacts |

---

## Writing Guidelines

### General Principles

1. **Write for the audience** - Each doc has a specific reader. Use appropriate terminology and detail level.

2. **Be actionable** - Include commands, links, and concrete steps. Not just descriptions.

3. **Highlight gaps and risks** - Don't hide problems. Call out missing pieces with recommendations.

4. **Use tables for structured data** - Dashboards, inventories, and lists work better as tables.

5. **Add context the YAML can't capture** - Explain why things are the way they are. Add recommendations.

6. **Cross-reference other docs** - Link to related documentation using relative paths.

### Structure Each Document

Every document should include:

```markdown
# [Document Title]

**Project**: {{ project_name }}
**Generated**: {{ date }}

---

## Dashboard

[Key metrics as a table - gives quick overview]

---

## [Main Sections]

[Content organized by topic]

---

## Related Documentation

[Links to other docs in the set]

---

*Generated by OpenSecKit /osk-discover on {{ timestamp }}*
```

### Mermaid Diagrams

Include diagrams where they add value:
- Architecture overview (flowchart)
- Data flows (sequence diagram)
- Trust boundaries (flowchart with subgraphs)
- Deployment pipeline (flowchart)

---

## Document Specifications

### 1. product.md

**Audience**: Product Managers, Stakeholders, Business Users

**Sources**: product.yaml, business.yaml, glossary.yaml, gaps.yaml

**Sections**:
- Dashboard (features count, maturity, KPIs status)
- Product Identity (vision, value proposition, differentiators)
- Business Context (domain, stakeholders, processes)
- Features Inventory (detailed feature cards)
- KPIs (business, technical, UX metrics)
- Roadmap (current quarter, future, tech debt)
- Risk Dashboard (high/critical gaps affecting product)
- Compliance Readiness (RGPD, RGS indicators)

**Writing notes**:
- Focus on business value, not technical details
- Explain features in terms of user benefit
- Highlight blockers and dependencies in roadmap

---

### 2. architecture.md

**Audience**: Architects, Senior Developers, Technical Leads

**Sources**: architecture.yaml, data.yaml, integrations.yaml, boundaries.yaml, supply_chain.yaml

**Sections**:
- Dashboard (components, APIs, integrations count)
- Architecture Overview (diagram + narrative)
- Technology Stack (languages, frameworks, infrastructure)
- Components Reference (detailed component cards)
- API Inventory (internal and external APIs)
- Data Flows (how data moves through the system)
- Data Dictionary (categories, fields, classification)
- Integration Points (external services with details)
- Trust Boundaries (security zones)
- Supply Chain (dependencies, SBOM status)
- ADRs (architecture decision records if any)

**Writing notes**:
- Include a system diagram (Mermaid flowchart)
- Explain architectural decisions and trade-offs
- Call out technical debt and evolution paths

---

### 3. developer.md

**Audience**: Developers (new and existing)

**Sources**: architecture.yaml, tooling.yaml, glossary.yaml, operations.yaml

**Sections**:
- Dashboard (tech stack summary)
- Quick Start (clone, setup, run)
- Development Environment (prerequisites, configuration)
- Architecture Overview (simplified, link to architecture.md)
- Domain Glossary (key terms developers need to know)
- API Reference (how to use internal APIs)
- Development Workflow (branching, PRs, CI/CD)
- Testing (how to run tests, coverage expectations)
- Troubleshooting (common issues and solutions)
- Team Contacts (who to ask for help)

**Writing notes**:
- Include actual commands (copy-pasteable)
- Keep it practical, not theoretical
- Link to more detailed docs for deep dives

---

### 4. security.md

**Audience**: Security Team, Auditors, Compliance Officers

**Sources**: controls.yaml, boundaries.yaml, data.yaml, gaps.yaml, integrations.yaml, supply_chain.yaml

**Sections**:
- Dashboard (controls count, gaps by severity, SLSA level)
- Trust Architecture (zones and boundaries)
- Security Controls Inventory (by category: auth, authz, encryption, logging, network)
- Threat Surface (integrations with data exposure, PII locations, privileged accounts)
- Supply Chain Security (artifact security, critical dependencies, threats)
- Gaps & Risks (critical/high gaps with details, remediation recommendations)
- Security Processes (code review, dependency updates, access review)
- Incident Response (escalation, severity levels, postmortem process)

**Writing notes**:
- Be specific about controls (not just "authentication" but how it works)
- Prioritize gaps clearly with rationale
- Include compliance implications (RGPD, RGS)

---

### 5. operations.md

**Audience**: DevOps, SRE, On-Call Engineers

**Sources**: operations.yaml, tooling.yaml, team.yaml

**Sections**:
- Dashboard (environments, alerts, runbooks count)
- Environments (detailed cards for each environment)
- Monitoring (dashboards, metrics, logs, tracing)
- Alerts (alert definitions with thresholds)
- Runbooks (step-by-step incident procedures)
- Deployments (strategy, steps, rollback)
- On-Call (rotation, escalation policy, expectations)
- Incident Management (severity levels, communication, postmortem)
- Maintenance (scheduled tasks, health checks)

**Writing notes**:
- Include actual commands in runbooks
- Make runbooks copy-pasteable during incidents
- Clearly mark what requires elevated access

---

### 6. onboarding.md

**Audience**: New Team Members (any role)

**Sources**: All YAML files (high-level overview)

**Sections**:
- Welcome (what is this project, why does it matter)
- Quick Start (get running in 5 minutes)
- Architecture (simplified overview with diagram)
- Key Concepts (essential glossary terms)
- Team & Contacts (who does what, how to reach them)
- Getting Started Checklist (actionable tasks for first week)
- Next Steps (which doc to read based on role)
- Known Gaps (what's missing, don't be surprised)

**Writing notes**:
- Keep it short and welcoming
- Link to detailed docs, don't duplicate
- Focus on "what do I need to know day 1"

---

## Generation Process

For each document:

1. **Read the relevant YAML files** from `.osk/system-model/`
2. **Understand the audience** - What do they need to know?
3. **Structure the content** - Follow the sections above
4. **Write clear prose** - Not just data dumps
5. **Add insights** - Recommendations, warnings, context
6. **Include diagrams** - Where they clarify architecture or flows
7. **Cross-reference** - Link to related docs
8. **Write the file** - Use the Write tool to create `.osk/docs/{filename}.md`

---

## Output Checklist

- [ ] `.osk/docs/product.md` written
- [ ] `.osk/docs/architecture.md` written
- [ ] `.osk/docs/developer.md` written
- [ ] `.osk/docs/security.md` written
- [ ] `.osk/docs/operations.md` written
- [ ] `.osk/docs/onboarding.md` written
- [ ] All docs have dashboards
- [ ] Mermaid diagrams included where useful
- [ ] Cross-references are correct
- [ ] Gaps and risks are highlighted

---

## Completion

After generating all 6 documents, update the workflow state:

```yaml
phases:
  documentation:
    status: "completed"
    completed_at: "{{ timestamp }}"
    output:
      - ".osk/docs/product.md"
      - ".osk/docs/architecture.md"
      - ".osk/docs/developer.md"
      - ".osk/docs/security.md"
      - ".osk/docs/operations.md"
      - ".osk/docs/onboarding.md"

workflow:
  status: "completed"
  completed_at: "{{ timestamp }}"
```

