# boundaries.yaml.j2 - Trust zones and trust boundaries between security perimeters
# REFS: controls.yaml, architecture.yaml

# TRUST_ZONES
trust_zones:
{% for zone in trust_zones %}
  - id: "{{ zone.id }}"
    name: "{{ zone.name }}"
    description: "{{ zone.description }}"
    trust_level: {{ zone.trust_level }}

    components: [{% for c in zone.components %}"{{ c }}"{% if not loop.last %}, {% endif %}{% endfor %}]

    security_controls:
{% for ctrl in zone.security_controls %}
      - "{{ ctrl }}"
{% endfor %}

    network_segment: "{{ zone.network_segment }}"
    access_restrictions: "{{ zone.access_restrictions }}"
{% endfor %}

# TRUST_BOUNDARIES
trust_boundaries:
{% for boundary in trust_boundaries %}
  - id: "{{ boundary.id }}"
    name: "{{ boundary.name }}"
    description: "{{ boundary.description }}"

    from_zone: "{{ boundary.from_zone }}"
    to_zone: "{{ boundary.to_zone }}"

    protocol: "{{ boundary.protocol }}"
    port: "{{ boundary.port }}"

    controls:
      authentication: "{{ boundary.controls.authentication }}"
      authorization: "{{ boundary.controls.authorization }}"
      encryption: "{{ boundary.controls.encryption }}"
      logging: {{ boundary.controls.logging }}
      rate_limiting: {{ boundary.controls.rate_limiting }}
      input_validation: {{ boundary.controls.input_validation }}

    data_crossing: [{% for d in boundary.data_crossing %}"{{ d }}"{% if not loop.last %}, {% endif %}{% endfor %}]

    threats:
{% for threat in boundary.threats %}
      - "{{ threat }}"
{% endfor %}

    risk_level: "{{ boundary.risk_level }}"
{% endfor %}
